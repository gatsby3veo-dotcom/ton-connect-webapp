<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TON Lootbox Mini App (Mock)</title>
  <style>
    :root{
      --bg:#0b0f1a;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.04);
      --stroke:rgba(255,255,255,.10);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.65);
      --muted2:rgba(255,255,255,.45);

      --g1:#7c3aed; /* purple */
      --g2:#06b6d4; /* cyan */
      --g3:#00f5d4; /* mint */
      --danger:#ff4d6d;
      --ok:#35e08a;

      --r:22px;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --glow: 0 0 40px rgba(124,58,237,.24), 0 0 70px rgba(6,182,212,.18);
      --glow2: 0 0 28px rgba(0,245,212,.18);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background:
        radial-gradient(900px 600px at 20% 10%, rgba(124,58,237,.22), transparent 55%),
        radial-gradient(900px 600px at 85% 20%, rgba(6,182,212,.18), transparent 55%),
        radial-gradient(900px 700px at 40% 90%, rgba(0,245,212,.12), transparent 60%),
        var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }

    /* Subtle noise */
    body:before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
      mix-blend-mode:overlay;
      opacity:.25;
    }

    .app{
      max-width:420px;
      margin:0 auto;
      padding:14px 14px 86px;
      position:relative;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:8px 6px 12px;
    }
    .brand{
      display:flex; gap:10px; align-items:center;
    }
    .logo{
      width:34px; height:34px; border-radius:12px;
      background:linear-gradient(135deg,var(--g1),var(--g2),var(--g3));
      box-shadow:var(--glow);
    }
    .brand h1{font-size:16px; margin:0; letter-spacing:.3px}
    .brand .sub{font-size:12px; color:var(--muted2); margin-top:2px}
    .actions{
      display:flex; gap:10px; align-items:center;
    }
    .iconbtn{
      width:38px; height:38px; border-radius:14px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      display:grid; place-items:center;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      cursor:pointer;
      user-select:none;
    }
    .iconbtn:active{transform:translateY(1px)}
    .dots{letter-spacing:2px; font-weight:700; opacity:.85}
    .x{font-weight:900; opacity:.75}

    .row{display:flex; gap:12px}

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.10);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .wallet{
      padding:14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }
    .wallet .left{
      display:flex; gap:12px; align-items:center;
      min-width:0;
    }
    .avatar{
      width:40px; height:40px; border-radius:16px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      position:relative;
      overflow:hidden;
    }
    .avatar:before{
      content:"";
      position:absolute; inset:-20%;
      background:conic-gradient(from 180deg, var(--g1), var(--g2), var(--g3), var(--g1));
      opacity:.65;
      filter: blur(12px);
    }
    .wallet .meta{min-width:0}
    .wallet .meta .label{font-size:12px; color:var(--muted2)}
    .wallet .meta .value{display:flex; align-items:center; gap:8px; margin-top:4px}
    .ton{
      width:18px; height:18px; border-radius:999px;
      background:linear-gradient(135deg,#39b6ff,#00f5d4);
      box-shadow: var(--glow2);
    }
    .amount{font-size:16px; font-weight:700}
    .btn{
      border:none;
      border-radius:16px;
      padding:11px 14px;
      font-weight:700;
      cursor:pointer;
      color:#0b0f1a;
      background:linear-gradient(135deg,var(--g1),var(--g2),var(--g3));
      box-shadow:var(--glow);
      display:inline-flex; align-items:center; gap:8px;
      white-space:nowrap;
    }
    .btn.secondary{
      background:rgba(255,255,255,.06);
      color:var(--text);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:none;
    }
    .btn:active{transform:translateY(1px)}

    .sectionTitle{
      font-size:12px;
      color:var(--muted2);
      margin:14px 6px 8px;
      letter-spacing:.6px;
      text-transform:uppercase;
    }

    .seasonCard{
      padding:16px;
      position:relative;
      overflow:hidden;
      margin-bottom:12px;
    }
    .seasonCard:before{
      content:"";
      position:absolute; inset:-40%;
      background:radial-gradient(circle at 30% 20%, rgba(124,58,237,.35), transparent 55%),
                 radial-gradient(circle at 70% 35%, rgba(6,182,212,.28), transparent 55%),
                 radial-gradient(circle at 60% 80%, rgba(0,245,212,.18), transparent 55%);
      filter: blur(0px);
    }
    .seasonCard .content{position:relative}
    .pillrow{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    .pill{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color:var(--muted);
    }
    .pill.good{border-color:rgba(53,224,138,.35); color:rgba(200,255,225,.92)}
    .pill.soon{border-color:rgba(255,255,255,.16); color:rgba(255,255,255,.70)}
    .seasonName{
      font-size:18px; font-weight:900;
      margin:10px 0 6px;
      letter-spacing:.5px;
    }
    .seasonDesc{color:var(--muted); font-size:13px; margin:0 0 10px}
    .kv{display:flex; gap:12px; flex-wrap:wrap; margin:10px 0 14px}
    .kv .item{
      flex:1 1 120px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      border-radius:16px;
      padding:10px 12px;
    }
    .kv .k{font-size:11px; color:var(--muted2)}
    .kv .v{font-size:14px; font-weight:800; margin-top:4px}

    .timer{
      display:flex; gap:8px; margin:12px 0 14px;
      flex-wrap:wrap;
    }
    .tbox{
      flex:1 1 70px;
      padding:10px 10px;
      border-radius:18px;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 0 30px rgba(124,58,237,.10);
      text-align:center;
    }
    .tbox .num{font-size:18px; font-weight:900; letter-spacing:.6px}
    .tbox .lab{font-size:10px; color:var(--muted2); margin-top:3px}

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:12px;
    }
    .boxCard{
      padding:12px;
      position:relative;
      overflow:hidden;
      cursor:pointer;
      min-height:140px;
    }
    .boxCard:before{
      content:"";
      position:absolute; inset:-60%;
      background:conic-gradient(from 210deg, rgba(124,58,237,.32), rgba(6,182,212,.22), rgba(0,245,212,.16), rgba(124,58,237,.28));
      filter: blur(24px);
      opacity:.8;
    }
    .boxCard .content{position:relative}
    .cube{
      width:54px; height:54px; border-radius:18px;
      background:linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 0 30px rgba(6,182,212,.12);
      margin-bottom:10px;
      position:relative;
    }
    .cube:after{
      content:"";
      position:absolute; inset:-1px;
      border-radius:18px;
      background:linear-gradient(135deg, rgba(124,58,237,.45), rgba(6,182,212,.35), rgba(0,245,212,.25));
      filter: blur(10px);
      opacity:.35;
      z-index:-1;
    }
    .boxTitle{font-weight:900; font-size:13px; margin:0 0 6px}
    .boxMeta{font-size:12px; color:var(--muted)}
    .status{
      display:inline-flex; align-items:center; gap:6px;
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
    }
    .dot{width:8px; height:8px; border-radius:999px; background:rgba(255,255,255,.35)}
    .dot.lock{background:rgba(255,255,255,.30)}
    .dot.ready{background:var(--ok)}
    .dot.opened{background:rgba(255,215,102,.85)}

    /* bottom nav */
    .nav{
      position:fixed;
      left:50%; transform:translateX(-50%);
      bottom:10px;
      width:min(420px, calc(100% - 20px));
      padding:10px;
      border-radius:22px;
      background:rgba(10,14,24,.65);
      border:1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      box-shadow:var(--shadow);
      display:flex;
      justify-content:space-between;
      gap:8px;
    }
    .nav button{
      flex:1;
      padding:10px 8px;
      border-radius:18px;
      background:transparent;
      border:1px solid transparent;
      color:var(--muted2);
      cursor:pointer;
      font-weight:700;
      font-size:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      user-select:none;
    }
    .nav button.active{
      color:var(--text);
      background:rgba(255,255,255,.06);
      border-color:rgba(255,255,255,.12);
      box-shadow: 0 0 26px rgba(124,58,237,.16);
    }

    /* pages */
    .page{display:none}
    .page.active{display:block}

    /* modal */
    .modalBack{
      position:fixed; inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding:14px;
      z-index:50;
    }
    .modalBack.show{display:flex}
    .sheet{
      width:min(420px, calc(100% - 0px));
      border-radius:26px;
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12);
      box-shadow:var(--shadow);
      padding:14px 14px 16px;
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }
    .handle{
      width:54px; height:5px; border-radius:99px;
      background:rgba(255,255,255,.18);
      margin:6px auto 10px;
    }
    .sheet h3{margin:6px 0 6px; font-size:16px}
    .sheet p{margin:0 0 12px; color:var(--muted); font-size:13px}
    .sheet .price{
      display:flex; justify-content:space-between; align-items:center;
      padding:10px 12px;
      border-radius:18px;
      background:rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      margin-bottom:12px;
    }
    .sheet .price .l{color:var(--muted2); font-size:12px}
    .sheet .price .r{font-weight:900}
    .sheet .row{gap:10px}
    .hint{font-size:12px; color:var(--muted2); margin-top:10px}

    /* small helpers */
    .muted{color:var(--muted)}
    .sep{height:1px; background:rgba(255,255,255,.10); margin:14px 6px}
    select, input{
      width:100%;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.12);
      color:var(--text);
      border-radius:16px;
      padding:10px 12px;
      outline:none;
    }
    .controlRow{
      display:flex; gap:10px; align-items:center; margin:10px 0 0;
    }
    .controlRow > *{flex:1}
    .mini{
      font-size:11px; color:var(--muted2); margin-top:8px; line-height:1.35;
    }

    .toast{
      position:fixed;
      left:50%; transform:translateX(-50%);
      bottom:92px;
      width:min(420px, calc(100% - 20px));
      display:none;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding:10px 12px;
      border-radius:18px;
      color:rgba(255,255,255,.85);
      z-index:60;
      box-shadow:var(--shadow);
      font-size:13px;
    }
    .toast.show{display:block}
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1 id="projectName">PROJECT_NAME</h1>
          <div class="sub">Telegram Mini App ‚Ä¢ TON Lootbox</div>
        </div>
      </div>
      <div class="actions">
        <div class="iconbtn" id="settingsBtn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"><span class="dots">‚ãÆ</span></div>
        <div class="iconbtn" id="closeBtn" title="–ó–∞–∫—Ä—ã—Ç—å"><span class="x">√ó</span></div>
      </div>
    </div>

    <!-- Wallet / balance -->
    <div class="card wallet">
      <div class="left">
        <div class="avatar" aria-hidden="true"></div>
        <div class="meta">
          <div class="label">–í–∞—à –∫–æ—à–µ–ª—ë–∫</div>
          <div class="value">
            <div class="ton" aria-hidden="true"></div>
            <div class="amount"><span id="tonBalance">0.00</span> TON</div>
          </div>
          <div class="mini" id="walletStatus">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</div>
        </div>
      </div>
      <button class="btn" id="connectBtn">–ü–æ–¥–∫–ª—é—á–∏—Ç—å</button>
    </div>

    <!-- Quick controls (for demo) -->
    <div class="card" style="padding:14px; margin-bottom:12px;">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
        <div>
          <div style="font-weight:900;">–î–µ–º–æ-–ø–∞–Ω–µ–ª—å (–¥–ª—è –º–∞–∫–µ—Ç–∞)</div>
          <div class="mini">–í—ã–±–∏—Ä–∞–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ–∑–æ–Ω–∞ –∏ —Å–º–æ—Ç—Ä–∏, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è UI. –í —Ä–µ–∞–ª—å–Ω–æ–º –º–∏–Ω–∏-–∞–ø–ø–µ —ç—Ç–æ –±—É–¥–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Å –±—ç–∫–∞.</div>
        </div>
      </div>
      <div class="controlRow">
        <div>
          <label class="mini">–°–æ—Å—Ç–æ—è–Ω–∏–µ Season 1</label>
          <select id="seasonState">
            <option value="mint">Free Mint Active</option>
            <option value="soldout">Sold Out + Countdown</option>
            <option value="open">Opening Live (Key required)</option>
          </select>
        </div>
        <div>
          <label class="mini">–¶–µ–Ω–∞ –∫–ª—é—á–∞ (TON)</label>
          <input id="keyPrice" type="number" step="0.1" value="2.5"/>
        </div>
      </div>
      <div class="mini">* –ú–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å —ç—Ç–æ—Ç –±–ª–æ–∫ –ø–æ–∑–∂–µ ‚Äî –æ–Ω —Å–¥–µ–ª–∞–Ω —Ç–æ–ª—å–∫–æ —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ.</div>
    </div>

    <!-- HOME PAGE -->
    <section class="page active" id="page-home">
      <div class="sectionTitle">–°–µ–∑–æ–Ω—ã</div>

      <!-- Season 1 -->
      <div class="card seasonCard" id="season1Card">
        <div class="content">
          <div class="pillrow">
            <span class="pill good" id="season1Pill">SEASON 1 ‚Ä¢ ACTIVE</span>
            <span class="pill" id="season1Subpill">10,000 BOXES</span>
          </div>
          <div class="seasonName">Season 1</div>
          <p class="seasonDesc" id="season1Desc">
            –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –º–∏–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω. –ó–∞–±–µ—Ä–∏ –±–æ–∫—Å, –ø–æ–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è –Ω–µ —Ä–∞–∑–æ–±—Ä–∞–Ω–∞.
          </p>

          <div class="kv">
            <div class="item">
              <div class="k">Supply</div>
              <div class="v">10,000</div>
            </div>
            <div class="item">
              <div class="k">Remaining</div>
              <div class="v"><span id="remaining">4238</span></div>
            </div>
            <div class="item">
              <div class="k">Key price</div>
              <div class="v"><span id="keyPriceText">2.5</span> TON</div>
            </div>
          </div>

          <!-- Timer (shown only in soldout) -->
          <div id="timerWrap" style="display:none;">
            <div class="pillrow" style="margin-bottom:8px;">
              <span class="pill">–û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–∞—á–Ω—ë—Ç—Å—è —á–µ—Ä–µ–∑</span>
            </div>
            <div class="timer">
              <div class="tbox"><div class="num" id="tD">02</div><div class="lab">–î–Ω–∏</div></div>
              <div class="tbox"><div class="num" id="tH">14</div><div class="lab">–ß–∞—Å—ã</div></div>
              <div class="tbox"><div class="num" id="tM">33</div><div class="lab">–ú–∏–Ω</div></div>
              <div class="tbox"><div class="num" id="tS">21</div><div class="lab">–°–µ–∫</div></div>
            </div>
          </div>

          <div class="row">
            <button class="btn" id="primarySeasonBtn">Mint Free Box</button>
            <button class="btn secondary" id="seasonInfoBtn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
          </div>

          <div class="hint" id="seasonHint">
            Free mint: 1 –±–æ–∫—Å –Ω–∞ –∫–æ—à–µ–ª—ë–∫ (–ø—Ä–∏–º–µ—Ä). –û—Ç–∫—Ä—ã—Ç–∏–µ ‚Äî –ø–æ—Å–ª–µ sold out –∏ —Ç–∞–π–º–µ—Ä–∞.
          </div>
        </div>
      </div>

      <!-- Season 2 -->
      <div class="card seasonCard" style="opacity:.82;">
        <div class="content">
          <div class="pillrow">
            <span class="pill soon">SEASON 2 ‚Ä¢ SOON</span>
            <span class="pill">10,000 BOXES</span>
          </div>
          <div class="seasonName">Season 2</div>
          <p class="seasonDesc">–°–∫–æ—Ä–æ. –°–ª–µ–¥–∏ –∑–∞ —Å—Ç–∞—Ä—Ç–æ–º –Ω–æ–≤–æ–≥–æ —Å–µ–∑–æ–Ω–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏–∏.</p>
          <div class="kv">
            <div class="item">
              <div class="k">Status</div>
              <div class="v">Coming Soon</div>
            </div>
            <div class="item">
              <div class="k">Starts in</div>
              <div class="v">‚Äî</div>
            </div>
            <div class="item">
              <div class="k">Notes</div>
              <div class="v">New drops</div>
            </div>
          </div>
          <button class="btn secondary" disabled style="opacity:.75; cursor:not-allowed;">–°–∫–æ—Ä–æ</button>
        </div>
      </div>
    </section>

    <!-- MY BOXES PAGE -->
    <section class="page" id="page-boxes">
      <div class="sectionTitle">–ú–æ–∏ –±–æ–∫—Å—ã ‚Ä¢ Season 1</div>
      <div class="grid" id="boxesGrid"></div>
      <div class="mini" style="margin:10px 6px 0;">
        –ù–∞–∂–º–∏ –Ω–∞ –±–æ–∫—Å ‚Üí –ø–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å —Ü–µ–Ω–æ–π –∏ –æ–ø–ª–∞—Ç–æ–π (–¥–µ–º–æ).
      </div>
    </section>

    <!-- REWARDS PAGE -->
    <section class="page" id="page-rewards">
      <div class="sectionTitle">–ù–∞–≥—Ä–∞–¥—ã ‚Ä¢ –†–µ–¥–∫–æ—Å—Ç–∏</div>

      <div class="card seasonCard">
        <div class="content">
          <div class="pillrow">
            <span class="pill">RARITY</span>
            <span class="pill">SEASON 1</span>
          </div>
          <div class="seasonName">Drop Rates</div>
          <p class="seasonDesc">–ü—Ä–æ—Ü–µ–Ω—Ç—ã –ø—Ä–∏–º–µ—Ä–Ω—ã–µ. –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –º–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å —Ç–æ—á–Ω—ã–µ —à–∞–Ω—Å—ã –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω—ã.</p>

          <div class="kv">
            <div class="item"><div class="k">Common</div><div class="v">62%</div></div>
            <div class="item"><div class="k">Rare</div><div class="v">25%</div></div>
            <div class="item"><div class="k">Epic</div><div class="v">10%</div></div>
            <div class="item"><div class="k">Legendary</div><div class="v">3%</div></div>
          </div>

          <button class="btn secondary" id="viewCollectionBtn">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é</button>
        </div>
      </div>
    </section>

    <!-- STATS PAGE -->
    <section class="page" id="page-stats">
      <div class="sectionTitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Ä¢ Season 1</div>

      <div class="card seasonCard">
        <div class="content">
          <div class="pillrow">
            <span class="pill">ON-CHAIN</span>
            <span class="pill">SUMMARY</span>
          </div>
          <div class="seasonName">Season 1 Stats</div>
          <p class="seasonDesc">–ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è –º–∞–∫–µ—Ç–∞ (–±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –±–ª–æ–∫—á–µ–π–Ω).</p>

          <div class="kv">
            <div class="item"><div class="k">Minted</div><div class="v">10,000 / 10,000</div></div>
            <div class="item"><div class="k">Opened</div><div class="v">4,322</div></div>
            <div class="item"><div class="k">TON spent</div><div class="v">10,805 TON</div></div>
          </div>

          <button class="btn secondary" id="refreshBtn">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
      </div>
    </section>
  </div>

  <!-- Bottom nav -->
  <nav class="nav">
    <button class="active" data-page="home">üè† –ì–ª–∞–≤–Ω–∞—è</button>
    <button data-page="boxes">üì¶ –ú–æ–∏ –±–æ–∫—Å—ã</button>
    <button data-page="rewards">üéñ –ù–∞–≥—Ä–∞–¥—ã</button>
    <button data-page="stats">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
  </nav>

  <!-- Bottom sheet modal -->
  <div class="modalBack" id="modalBack">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="handle"></div>
      <h3 id="modalTitle">NFT BOX</h3>
      <p id="modalDesc">–û—Ç–∫—Ä—ã—Ç–∏–µ —Ç—Ä–µ–±—É–µ—Ç –∫–ª—é—á. –û–ø–ª–∞—Ç–∞ –±—É–¥–µ—Ç —Å–ø–∏—Å–∞–Ω–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ TON –∫–æ—à–µ–ª—å–∫–∞.</p>

      <div class="price">
        <div class="l">–¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è</div>
        <div class="r"><span id="modalPrice">2.5</span> TON</div>
      </div>

      <div class="row">
        <button class="btn" id="payOpenBtn">–û–ø–ª–∞—Ç–∏—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å</button>
        <button class="btn secondary" id="closeModalBtn">–û—Ç–º–µ–Ω–∞</button>
      </div>

      <div class="hint" id="modalHint">
        –í –¥–µ–º–æ –º—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –í —Ä–µ–∞–ª—å–Ω–æ–º Mini App —Ç—É—Ç –±—É–¥–µ—Ç TonConnect.
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // ---- Demo data ----
    const state = {
      walletConnected: false,
      balance: 0.00,
      season1: {
        supply: 10000,
        remaining: 4238,
        keyPrice: 2.5,
        mode: "mint", // mint | soldout | open
        // countdown ends at:
        countdownEnd: Date.now() + (2*24*3600 + 14*3600 + 33*60 + 21)*1000
      },
      boxes: Array.from({length: 10}).map((_,i)=>({
        id: 1000 + i,
        status: "locked" // locked | ready | opened
      })),
      selectedBoxId: null
    };

    // ---- Elements ----
    const connectBtn = document.getElementById("connectBtn");
    const tonBalance = document.getElementById("tonBalance");
    const walletStatus = document.getElementById("walletStatus");

    const seasonState = document.getElementById("seasonState");
    const keyPriceInput = document.getElementById("keyPrice");

    const remainingEl = document.getElementById("remaining");
    const keyPriceText = document.getElementById("keyPriceText");
    const season1Pill = document.getElementById("season1Pill");
    const season1Subpill = document.getElementById("season1Subpill");
    const season1Desc = document.getElementById("season1Desc");
    const primarySeasonBtn = document.getElementById("primarySeasonBtn");
    const timerWrap = document.getElementById("timerWrap");
    const seasonHint = document.getElementById("seasonHint");

    const tD=document.getElementById("tD"), tH=document.getElementById("tH"),
          tM=document.getElementById("tM"), tS=document.getElementById("tS");

    const boxesGrid = document.getElementById("boxesGrid");
    const modalBack = document.getElementById("modalBack");
    const modalTitle = document.getElementById("modalTitle");
    const modalPrice = document.getElementById("modalPrice");
    const payOpenBtn = document.getElementById("payOpenBtn");
    const closeModalBtn = document.getElementById("closeModalBtn");
    const toast = document.getElementById("toast");

    // ---- Helpers ----
    function fmt2(n){ return String(n).padStart(2,"0"); }
    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), 2200);
    }

    function setWalletConnected(v){
      state.walletConnected = v;
      if(v){
        state.balance = 1.234; // demo
        connectBtn.textContent = "–ü–æ–ø–æ–ª–Ω–∏—Ç—å";
        walletStatus.textContent = "–ö–æ—à–µ–ª—ë–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω";
        showToast("–ö–æ—à–µ–ª—ë–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω (–¥–µ–º–æ)");
      }else{
        state.balance = 0.00;
        connectBtn.textContent = "–ü–æ–¥–∫–ª—é—á–∏—Ç—å";
        walletStatus.textContent = "–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω";
      }
      tonBalance.textContent = state.balance.toFixed(2);
      render();
    }

    function applySeasonMode(mode){
      state.season1.mode = mode;
      // For demo: set statuses of boxes depending on mode
      if(mode === "mint"){
        state.boxes.forEach(b=>b.status="locked");
      }
      if(mode === "soldout"){
        state.boxes.forEach(b=>b.status="locked");
      }
      if(mode === "open"){
        // Some boxes can be ready
        state.boxes.forEach((b,idx)=> b.status = idx < 6 ? "ready" : "locked");
      }
      render();
    }

    function renderSeasonCard(){
      const s = state.season1;
      remainingEl.textContent = s.remaining.toLocaleString("ru-RU");
      keyPriceText.textContent = Number(s.keyPrice).toFixed(1);

      // Update main CTA & text
      if(s.mode === "mint"){
        season1Pill.textContent = "SEASON 1 ‚Ä¢ ACTIVE";
        season1Pill.className = "pill good";
        season1Subpill.textContent = "FREE MINT";
        season1Desc.textContent = "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –º–∏–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω. –ó–∞–±–µ—Ä–∏ –±–æ–∫—Å, –ø–æ–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è –Ω–µ —Ä–∞–∑–æ–±—Ä–∞–Ω–∞.";
        primarySeasonBtn.textContent = "Mint Free Box";
        primarySeasonBtn.disabled = false;
        timerWrap.style.display = "none";
        seasonHint.textContent = "Free mint: 1 –±–æ–∫—Å –Ω–∞ –∫–æ—à–µ–ª—ë–∫ (–ø—Ä–∏–º–µ—Ä). –û—Ç–∫—Ä—ã—Ç–∏–µ ‚Äî –ø–æ—Å–ª–µ sold out –∏ —Ç–∞–π–º–µ—Ä–∞.";
      }

      if(s.mode === "soldout"){
        season1Pill.textContent = "SEASON 1 ‚Ä¢ SOLD OUT";
        season1Pill.className = "pill";
        season1Subpill.textContent = "COUNTDOWN";
        season1Desc.textContent = "–í—Å–µ –±–æ–∫—Å—ã —Ä–∞–∑–æ–±—Ä–∞–Ω—ã. –î–æ–∂–¥–∏—Å—å —Ç–∞–π–º–µ—Ä–∞ ‚Äî –ø–æ—Å–ª–µ –Ω–µ–≥–æ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.";
        primarySeasonBtn.textContent = "–û–∂–∏–¥–∞–Ω–∏–µ...";
        primarySeasonBtn.disabled = true;
        timerWrap.style.display = "block";
        seasonHint.textContent = "–û—Ç–∫—Ä—ã—Ç–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ—Å–ª–µ –∫–æ–Ω—Ü–∞ —Ç–∞–π–º–µ—Ä–∞. –î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω—É–∂–µ–Ω –∫–ª—é—á (TON).";
      }

      if(s.mode === "open"){
        season1Pill.textContent = "SEASON 1 ‚Ä¢ OPENING LIVE";
        season1Pill.className = "pill good";
        season1Subpill.textContent = "KEY REQUIRED";
        season1Desc.textContent = "–û—Ç–∫—Ä—ã—Ç–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ. –ö—É–ø–∏ –∫–ª—é—á –∏ –æ—Ç–∫—Ä—ã–≤–∞–π —Å–≤–æ–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ.";
        primarySeasonBtn.textContent = "–ö—É–ø–∏—Ç—å –∫–ª—é—á";
        primarySeasonBtn.disabled = false;
        timerWrap.style.display = "none";
        seasonHint.textContent = "1 –∫–ª—é—á = 1 –æ—Ç–∫—Ä—ã—Ç–∏–µ. –û—Ç–∫—Ä—ã–≤–∞–π –±–æ–∫—Å—ã –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ú–æ–∏ –±–æ–∫—Å—ã¬ª.";
      }
    }

    function renderBoxes(){
      boxesGrid.innerHTML = "";
      state.boxes.forEach(b=>{
        const el = document.createElement("div");
        el.className = "card boxCard";
        const dotClass = b.status === "ready" ? "ready" : (b.status === "opened" ? "opened" : "lock");
        const statusText = b.status === "ready" ? "Ready to open" : (b.status === "opened" ? "Opened" : "Locked");

        el.innerHTML = `
          <div class="content">
            <div class="cube" aria-hidden="true"></div>
            <div class="boxTitle">NFT BOX #${b.id}</div>
            <div class="boxMeta">Season 1 ‚Ä¢ Collection</div>
            <div class="status"><span class="dot ${dotClass}"></span> ${statusText}</div>
          </div>
        `;

        el.addEventListener("click", ()=>{
          // Only allow open if mode=open and box is ready
          if(state.season1.mode !== "open"){
            showToast("–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –ñ–¥–∏ —Ç–∞–π–º–µ—Ä.");
            return;
          }
          if(b.status !== "ready"){
            showToast("–≠—Ç–æ—Ç –±–æ–∫—Å –ø–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤ –∫ –æ—Ç–∫—Ä—ã—Ç–∏—é (–¥–µ–º–æ).");
            return;
          }
          openModal(b.id);
        });

        boxesGrid.appendChild(el);
      });
    }

    function openModal(boxId){
      state.selectedBoxId = boxId;
      modalTitle.textContent = `NFT BOX #${boxId}`;
      modalPrice.textContent = Number(state.season1.keyPrice).toFixed(1);
      modalBack.classList.add("show");
    }
    function closeModal(){
      modalBack.classList.remove("show");
      state.selectedBoxId = null;
    }

    function tickCountdown(){
      if(state.season1.mode !== "soldout") return;
      const diff = Math.max(0, state.season1.countdownEnd - Date.now());
      const totalSec = Math.floor(diff/1000);
      const d = Math.floor(totalSec / 86400);
      const h = Math.floor((totalSec % 86400) / 3600);
      const m = Math.floor((totalSec % 3600) / 60);
      const s = totalSec % 60;

      tD.textContent = fmt2(d);
      tH.textContent = fmt2(h);
      tM.textContent = fmt2(m);
      tS.textContent = fmt2(s);

      if(diff === 0){
        // switch to opening live
        applySeasonMode("open");
        showToast("–¢–∞–π–º–µ—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è ‚Äî –æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ!");
      }
    }

    function render(){
      // wallet
      tonBalance.textContent = state.balance.toFixed(2);
      keyPriceText.textContent = Number(state.season1.keyPrice).toFixed(1);

      // season card
      renderSeasonCard();

      // boxes
      renderBoxes();
    }

    // ---- Navigation ----
    const navButtons = document.querySelectorAll(".nav button");
    const pages = {
      home: document.getElementById("page-home"),
      boxes: document.getElementById("page-boxes"),
      rewards: document.getElementById("page-rewards"),
      stats: document.getElementById("page-stats")
    };
    function go(page){
      Object.values(pages).forEach(p=>p.classList.remove("active"));
      pages[page].classList.add("active");
      navButtons.forEach(b=>b.classList.toggle("active", b.dataset.page === page));
    }
    navButtons.forEach(btn=>btn.addEventListener("click", ()=>go(btn.dataset.page)));

    // ---- Events ----
    connectBtn.addEventListener("click", ()=>{
      if(!state.walletConnected) setWalletConnected(true);
      else showToast("–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Äî –∑–∞–≥–ª—É—à–∫–∞ (–¥–µ–º–æ)");
    });

    document.getElementById("closeBtn").addEventListener("click", ()=>showToast("–ó–∞–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–∞–ø–ø (–¥–µ–º–æ)"));
    document.getElementById("settingsBtn").addEventListener("click", ()=>showToast("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–¥–µ–º–æ)"));

    document.getElementById("seasonInfoBtn").addEventListener("click", ()=>showToast("–ò–Ω—Ñ–æ –æ —Å–µ–∑–æ–Ω–µ (–¥–µ–º–æ)"));
    document.getElementById("viewCollectionBtn").addEventListener("click", ()=>showToast("–û—Ç–∫—Ä—ã—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é (–¥–µ–º–æ)"));
    document.getElementById("refreshBtn").addEventListener("click", ()=>showToast("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–¥–µ–º–æ)"));

    primarySeasonBtn.addEventListener("click", ()=>{
      const mode = state.season1.mode;
      if(mode === "mint"){
        if(!state.walletConnected){
          showToast("–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª—ë–∫ (–¥–µ–º–æ)");
          return;
        }
        if(state.season1.remaining <= 0){
          applySeasonMode("soldout");
          return;
        }
        state.season1.remaining -= 1;
        showToast("–ë–æ–∫—Å –∑–∞–º–∏–Ω—á–µ–Ω –±–µ—Å–ø–ª–∞—Ç–Ω–æ (–¥–µ–º–æ)");
        // Give user a new box
        state.boxes.unshift({id: Math.floor(10000 + Math.random()*90000), status:"locked"});
        if(state.season1.remaining === 0){
          applySeasonMode("soldout");
          showToast("–í—Å–µ –±–æ–∫—Å—ã —Ä–∞–∑–æ–±—Ä–∞–Ω—ã ‚Äî –≤–∫–ª—é—á—ë–Ω —Ç–∞–π–º–µ—Ä");
        }
        render();
      }
      if(mode === "open"){
        if(!state.walletConnected){
          showToast("–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª—ë–∫ (–¥–µ–º–æ)");
          return;
        }
        showToast(`–ü–æ–∫—É–ø–∫–∞ –∫–ª—é—á–∞ ${state.season1.keyPrice.toFixed(1)} TON (–¥–µ–º–æ)`);
      }
    });

    seasonState.addEventListener("change", (e)=>{
      applySeasonMode(e.target.value);
    });

    keyPriceInput.addEventListener("input", (e)=>{
      const v = Math.max(0, Number(e.target.value || 0));
      state.season1.keyPrice = v;
      render();
    });

    modalBack.addEventListener("click", (e)=>{
      if(e.target === modalBack) closeModal();
    });
    closeModalBtn.addEventListener("click", closeModal);

    payOpenBtn.addEventListener("click", ()=>{
      if(!state.walletConnected){
        showToast("–ü–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª—ë–∫ –¥–ª—è –æ–ø–ª–∞—Ç—ã (–¥–µ–º–æ)");
        return;
      }
      const id = state.selectedBoxId;
      showToast(`–û–ø–ª–∞—Ç–∞ ${state.season1.keyPrice.toFixed(1)} TON –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ BOX #${id} (–¥–µ–º–æ)`);
      // Mark box as opened
      const b = state.boxes.find(x=>x.id===id);
      if(b) b.status = "opened";
      closeModal();
      render();
      // In real app: navigate to reveal screen
    });

    // ---- init ----
    // sync controls
    seasonState.value = state.season1.mode;
    keyPriceInput.value = state.season1.keyPrice;
    render();

    // countdown loop
    setInterval(tickCountdown, 1000);
  </script>
</body>
</html>
